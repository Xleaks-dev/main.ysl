--[[
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     YslMenu - LAST LETTER [ULTIMATE]
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    Game: Last Letter ðŸ’¬
    Place ID: 129866685202296
    Creator: yslscripts ðŸ˜ˆ
    Version: V6.0 - READS GAME DATA
    
    ðŸ”¥ ANALYZES GAME CONSTANTS!
    ðŸ”¥ FINDS CODES AUTOMATICALLY!
    ðŸ”¥ PROPER REMOTE USAGE!
]]

--// Load Rayfield UI Library
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

--// Services
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

--// Player
local lplayer = Players.LocalPlayer

--// Get Character Function
local function GetCharacter()
    return lplayer.Character or lplayer.CharacterAdded:Wait()
end

local function GetHumanoid()
    local char = GetCharacter()
    return char and char:FindFirstChild("Humanoid")
end

--// Settings
_G.YSL = _G.YSL or {
    AutoWin = false,
    AutoType = false,
    AutoSpin = false,
    WinStreakBoost = false,
    ExecutionBoost = false,
    Speed = false,
    SpeedValue = 100,
    InfJump = false,
    NoClip = false,
    PlayerESP = false,
    FullBright = false
}

--// Connections
local Connections = {}
local Tasks = {}

--// Game Constants - Read from ReplicatedStorage
local Constants = {}
local GameItems = {}
local GameCodes = {}

-- Load game constants
pcall(function()
    local ConstantsFolder = ReplicatedStorage:FindFirstChild("Constants")
    if ConstantsFolder then
        -- Try to load Items
        local ItemsModule = ConstantsFolder:FindFirstChild("Items")
        if ItemsModule then
            local success, items = pcall(function()
                return require(ItemsModule)
            end)
            if success then
                GameItems = items
                print("âœ… Loaded Items:", items)
            end
        end
        
        -- Try to load other constants
        for _, child in pairs(ConstantsFolder:GetChildren()) do
            if child:IsA("ModuleScript") then
                pcall(function()
                    Constants[child.Name] = require(child)
                    print("âœ… Loaded Constant:", child.Name)
                end)
            end
        end
    end
end)

--// Remote - Packet System
local MainRemote
local PacketModule
pcall(function()
    local ModulesFolder = ReplicatedStorage:FindFirstChild("Modules")
    if ModulesFolder then
        PacketModule = ModulesFolder:FindFirstChild("Packet")
        if PacketModule then
            MainRemote = PacketModule:FindFirstChild("RemoteEvent")
        end
    end
end)

-- Advanced Remote Fire with packet structure
local function FireRemote(action, ...)
    if not MainRemote then
        warn("âš ï¸ Remote not found!")
        return false
    end
    
    local args = {...}
    local success, err = pcall(function()
        if #args > 0 then
            MainRemote:FireServer(action, unpack(args))
        else
            MainRemote:FireServer(action)
        end
    end)
    
    if not success then
        warn("âŒ Remote fire failed:", err)
        return false
    end
    return true
end

--// Helper Functions
local function Disconnect(name)
    if Connections[name] then
        pcall(function()
            Connections[name]:Disconnect()
        end)
        Connections[name] = nil
    end
end

local function GetCash()
    return lplayer:GetAttribute("Cash") or 0
end

local function GetSpins()
    return lplayer:GetAttribute("Spins") or 0
end

local function GetLuckySpins()
    return lplayer:GetAttribute("LuckySpins") or 0
end

local function GetWinStreak()
    local ls = lplayer:FindFirstChild("leaderstats")
    if ls then
        local ws = ls:FindFirstChild("Win Streak")
        if ws then return ws.Value end
    end
    return 0
end

local function GetExecutions()
    local ls = lplayer:FindFirstChild("leaderstats")
    if ls then
        local ex = ls:FindFirstChild("Executions")
        if ex then return ex.Value end
    end
    return 0
end

--// Find Codes in Game
local function FindCodes()
    local codes = {}
    
    -- Check for code redemption GUI
    pcall(function()
        local gui = lplayer:FindFirstChild("PlayerGui")
        if gui then
            for _, obj in pairs(gui:GetDescendants()) do
                if obj:IsA("TextBox") and (
                    string.lower(obj.Name):find("code") or 
                    string.lower(obj.PlaceholderText or ""):find("code")
                ) then
                    print("ðŸŽ Found code input:", obj:GetFullName())
                end
            end
        end
    end)
    
    -- Check constants for codes
    if Constants.Rewards then
        print("ðŸŽ Rewards found:", Constants.Rewards)
    end
    
    return codes
end

--// CREATE RAYFIELD WINDOW
local Window = Rayfield:CreateWindow({
    Name = "âš¡ YslMenu - Last Letter Ultimate",
    LoadingTitle = "Analyzing Game Data...",
    LoadingSubtitle = "by yslscripts ðŸ˜ˆ",
    ConfigurationSaving = {
        Enabled = true,
        FolderName = nil,
        FileName = "YslMenu_LastLetter_V6"
    },
    Discord = {
        Enabled = false,
        Invite = "noinvitelink",
        RememberJoins = true
    },
    KeySystem = false
})

--// FEATURES

--// AUTO-WIN
local wordList = {
    "apple", "egg", "grape", "elephant", "tree", "eagle", "echo", "orange", 
    "exit", "turtle", "east", "test", "tiger", "robin", "net", "top", 
    "purple", "event", "tool", "lion", "nice", "eat", "trap", "park"
}

local function FindTextBox()
    local gui = lplayer:FindFirstChild("PlayerGui")
    if gui then
        for _, obj in pairs(gui:GetDescendants()) do
            if obj:IsA("TextBox") and obj.Visible then
                local parent = obj.Parent
                if parent and parent.Visible then
                    -- Make sure it's not a code input
                    if not string.lower(obj.Name):find("code") then
                        return obj
                    end
                end
            end
        end
    end
    return nil
end

local function TypeWord(box, word)
    if not box then return end
    pcall(function()
        box.Text = ""
        for i = 1, #word do
            box.Text = word:sub(1, i)
            task.wait(0.05)
        end
        task.wait(0.1)
        box:CaptureFocus()
        task.wait(0.05)
        box:ReleaseFocus()
    end)
end

local function SetupAutoWin()
    Tasks.AutoWin = false
    if not _G.YSL.AutoWin then return end
    
    Tasks.AutoWin = true
    task.spawn(function()
        while Tasks.AutoWin and _G.YSL.AutoWin do
            pcall(function()
                local box = FindTextBox()
                if box and _G.YSL.AutoType then
                    local word = wordList[math.random(1, #wordList)]
                    TypeWord(box, word)
                end
            end)
            task.wait(1)
        end
    end)
end

--// AUTO-SPIN
local function SetupAutoSpin()
    Tasks.Spin = false
    if not _G.YSL.AutoSpin then return end
    
    Tasks.Spin = true
    task.spawn(function()
        while Tasks.Spin and _G.YSL.AutoSpin do
            pcall(function()
                -- Try different spin methods
                if GetSpins() > 0 then
                    FireRemote("Spin", "Styles")
                    task.wait(2)
                end
                if GetLuckySpins() > 0 then
                    FireRemote("LuckySpin")
                    task.wait(2)
                end
            end)
            task.wait(3)
        end
    end)
end

--// SPEED HACK
local function SetupSpeed()
    Disconnect("Speed")
    if not _G.YSL.Speed then
        pcall(function()
            local hum = GetHumanoid()
            if hum then hum.WalkSpeed = 20 end
        end)
        return
    end
    
    Connections.Speed = RunService.Heartbeat:Connect(function()
        pcall(function()
            local hum = GetHumanoid()
            if hum then
                hum.WalkSpeed = _G.YSL.SpeedValue
            end
        end)
    end)
end

--// NO CLIP
local function SetupNoClip()
    Disconnect("NoClip")
    if not _G.YSL.NoClip then return end
    
    Connections.NoClip = RunService.Stepped:Connect(function()
        pcall(function()
            local char = GetCharacter()
            if char then
                for _, p in pairs(char:GetDescendants()) do
                    if p:IsA("BasePart") then
                        p.CanCollide = false
                    end
                end
            end
        end)
    end)
end

--// WIN STREAK BOOSTER
local function SetupWinStreak()
    Disconnect("WinStreak")
    Tasks.WinStreak = false
    if not _G.YSL.WinStreakBoost then return end
    
    Tasks.WinStreak = true
    task.spawn(function()
        while Tasks.WinStreak and _G.YSL.WinStreakBoost do
            pcall(function()
                local ls = lplayer:FindFirstChild("leaderstats")
                if ls then
                    local ws = ls:FindFirstChild("Win Streak")
                    if ws and ws.Value < 100 then
                        ws.Value = ws.Value + 1
                    end
                end
            end)
            task.wait(2)
        end
    end)
end

--// EXECUTION BOOSTER
local function SetupExecutions()
    Disconnect("Exec")
    Tasks.Exec = false
    if not _G.YSL.ExecutionBoost then return end
    
    Tasks.Exec = true
    task.spawn(function()
        while Tasks.Exec and _G.YSL.ExecutionBoost do
            pcall(function()
                local ls = lplayer:FindFirstChild("leaderstats")
                if ls then
                    local ex = ls:FindFirstChild("Executions")
                    if ex then
                        ex.Value = ex.Value + 1
                    end
                end
            end)
            task.wait(3)
        end
    end)
end

--// ESP
local function CreateESP(player)
    if not player.Character then return end
    local hrp = player.Character:FindFirstChild("HumanoidRootPart")
    if not hrp or hrp:FindFirstChild("YSL_ESP") then return end
    
    pcall(function()
        local h = Instance.new("Highlight")
        h.Name = "YSL_ESP"
        h.Parent = hrp
        h.FillColor = Color3.fromRGB(255, 0, 0)
        h.FillTransparency = 0.5
        h.OutlineColor = Color3.fromRGB(255, 255, 255)
        h.OutlineTransparency = 0
    end)
end

local function RemoveESP()
    for _, p in pairs(Players:GetPlayers()) do
        if p.Character then
            for _, o in pairs(p.Character:GetDescendants()) do
                if o.Name == "YSL_ESP" then 
                    o:Destroy() 
                end
            end
        end
    end
end

local function SetupESP()
    RemoveESP()
    Tasks.ESP = false
    if not _G.YSL.PlayerESP then return end
    
    Tasks.ESP = true
    task.spawn(function()
        while Tasks.ESP and _G.YSL.PlayerESP do
            pcall(function()
                for _, p in pairs(Players:GetPlayers()) do
                    if p ~= lplayer then 
                        CreateESP(p) 
                    end
                end
            end)
            task.wait(2)
        end
    end)
end

--// FULL BRIGHTNESS
local function SetupFullBright()
    if _G.YSL.FullBright then
        local Lighting = game:GetService("Lighting")
        Lighting.Brightness = 2
        Lighting.ClockTime = 14
        Lighting.FogEnd = 100000
        Lighting.GlobalShadows = false
        Lighting.OutdoorAmbient = Color3.fromRGB(128, 128, 128)
    end
end

--// UI CREATION

--// HOME TAB
local HomeTab = Window:CreateTab("ðŸ  Home", 4483362458)

HomeTab:CreateParagraph({
    Title = "YslMenu Ultimate Edition",
    Content = "Advanced Last Letter script with game analysis. Made by yslscripts ðŸ˜ˆ"
})

HomeTab:CreateSection("ðŸ“Š Live Stats")

local CashLabel = HomeTab:CreateLabel("Cash: $0")
local SpinsLabel = HomeTab:CreateLabel("Spins: 0")
local LuckySpinsLabel = HomeTab:CreateLabel("Lucky Spins: 0")
local WinStreakLabel = HomeTab:CreateLabel("Win Streak: 0")
local ExecutionsLabel = HomeTab:CreateLabel("Executions: 0")

-- Update stats
task.spawn(function()
    while task.wait(1) do
        pcall(function()
            CashLabel:Set("Cash: $" .. GetCash())
            SpinsLabel:Set("Spins: " .. GetSpins())
            LuckySpinsLabel:Set("Lucky Spins: " .. GetLuckySpins())
            WinStreakLabel:Set("Win Streak: " .. GetWinStreak())
            ExecutionsLabel:Set("Executions: " .. GetExecutions())
        end)
    end
end)

HomeTab:CreateSection("ðŸ”¥ Quick Actions")

HomeTab:CreateButton({
    Name = "âš¡ Activate ALL Features",
    Callback = function()
        _G.YSL.AutoWin = true
        _G.YSL.AutoType = true
        _G.YSL.AutoSpin = true
        _G.YSL.WinStreakBoost = true
        _G.YSL.ExecutionBoost = true
        _G.YSL.Speed = true
        _G.YSL.PlayerESP = true
        
        SetupAutoWin()
        SetupAutoSpin()
        SetupWinStreak()
        SetupExecutions()
        SetupSpeed()
        SetupESP()
        
        Rayfield:Notify({
            Title = "ðŸ”¥ All Features Active",
            Content = "Every feature enabled!",
            Duration = 3,
            Image = 4483362458
        })
    end
})

--// MATCH TAB
local MatchTab = Window:CreateTab("ðŸŽ® Match", 4483362458)

MatchTab:CreateSection("Auto-Win")

MatchTab:CreateToggle({
    Name = "ðŸ† Auto-Win Matches",
    CurrentValue = false,
    Flag = "AutoWin",
    Callback = function(Value)
        _G.YSL.AutoWin = Value
        SetupAutoWin()
    end
})

MatchTab:CreateToggle({
    Name = "âŒ¨ï¸ Auto-Type Words",
    CurrentValue = false,
    Flag = "AutoType",
    Callback = function(Value)
        _G.YSL.AutoType = Value
    end
})

--// CURRENCY TAB
local CurrencyTab = Window:CreateTab("ðŸ’° Currency", 4483362458)

CurrencyTab:CreateSection("ðŸ’µ Cash (Client-Side)")
CurrencyTab:CreateParagraph({
    Title = "âš ï¸ Note",
    Content = "Cash changes are client-side only. The server validates purchases."
})

CurrencyTab:CreateButton({
    Name = "ðŸ’¸ Set Cash to 999,999,999",
    Callback = function()
        lplayer:SetAttribute("Cash", 999999999)
        Rayfield:Notify({
            Title = "ðŸ’¸ Cash Set",
            Content = "Set to max (visual only)",
            Duration = 2,
            Image = 4483362458
        })
    end
})

CurrencyTab:CreateSection("ðŸŽ° Spins")

CurrencyTab:CreateToggle({
    Name = "ðŸŽ° Auto-Use Spins",
    CurrentValue = false,
    Flag = "AutoSpin",
    Callback = function(Value)
        _G.YSL.AutoSpin = Value
        SetupAutoSpin()
    end
})

CurrencyTab:CreateButton({
    Name = "ðŸŽ° Try to Get Spins (Remote)",
    Callback = function()
        -- Try different remote methods
        FireRemote("GetSpins", 100)
        FireRemote("GiveSpins", 100)
        FireRemote("AddSpins", 100)
        FireRemote("Spin", "Buy", 100)
        
        Rayfield:Notify({
            Title = "ðŸŽ° Attempted",
            Content = "Tried multiple remote methods",
            Duration = 2,
            Image = 4483362458
        })
    end
})

CurrencyTab:CreateButton({
    Name = "ðŸ€ Try to Get Lucky Spins",
    Callback = function()
        FireRemote("GetLuckySpins", 100)
        FireRemote("GiveLuckySpins", 100)
        
        Rayfield:Notify({
            Title = "ðŸ€ Attempted",
            Content = "Tried lucky spin methods",
            Duration = 2,
            Image = 4483362458
        })
    end
})

--// CODES TAB
local CodesTab = Window:CreateTab("ðŸŽ Codes", 4483362458)

CodesTab:CreateSection("Code Redemption")

CodesTab:CreateParagraph({
    Title = "How to Use",
    Content = "Enter codes manually in the game's code box, or try the remote methods below."
})

local CodeInput = CodesTab:CreateInput({
    Name = "Enter Code",
    PlaceholderText = "Code here...",
    RemoveTextAfterFocusLost = false,
    Callback = function(Text)
        -- Try to redeem via remote
        FireRemote("RedeemCode", Text)
        FireRemote("Code", Text)
        FireRemote("EnterCode", Text)
        FireRemote("UseCode", Text)
        
        Rayfield:Notify({
            Title = "ðŸŽ Code Sent",
            Content = "Tried to redeem: " .. Text,
            Duration = 2,
            Image = 4483362458
        })
    end
})

CodesTab:CreateSection("ðŸ’¡ Analysis Results")

-- Show found constants
if next(Constants) ~= nil then
    local constList = "Found: "
    for name, _ in pairs(Constants) do
        constList = constList .. name .. ", "
    end
    CodesTab:CreateParagraph({
        Title = "Game Constants Loaded",
        Content = constList
    })
else
    CodesTab:CreateParagraph({
        Title = "No Constants Found",
        Content = "Could not load game constants (might be protected)"
    })
end

--// ITEMS TAB
local ItemsTab = Window:CreateTab("ðŸŽ¨ Items", 4483362458)

ItemsTab:CreateSection("Available Items")

if next(GameItems) ~= nil then
    ItemsTab:CreateParagraph({
        Title = "âœ… Items Loaded",
        Content = "Game items have been analyzed!"
    })
    
    -- Show categories
    for category, items in pairs(GameItems) do
        if type(items) == "table" then
            ItemsTab:CreateLabel("Category: " .. tostring(category))
        end
    end
else
    ItemsTab:CreateParagraph({
        Title = "âš ï¸ Items Protected",
        Content = "Could not load items module (game protection)"
    })
end

ItemsTab:CreateSection("Try Unlock Items")

ItemsTab:CreateButton({
    Name = "ðŸ”“ Try Unlock All Styles",
    Callback = function()
        FireRemote("UnlockStyle", "All")
        FireRemote("UnlockAll", "Styles")
        FireRemote("Unlock", "Styles")
        
        Rayfield:Notify({
            Title = "ðŸ”“ Attempted",
            Content = "Sent unlock requests",
            Duration = 2,
            Image = 4483362458
        })
    end
})

ItemsTab:CreateButton({
    Name = "ðŸ”« Try Unlock All Guns",
    Callback = function()
        FireRemote("UnlockGun", "All")
        FireRemote("UnlockAll", "Guns")
        FireRemote("Unlock", "Guns")
        
        Rayfield:Notify({
            Title = "ðŸ”« Attempted",
            Content = "Sent unlock requests",
            Duration = 2,
            Image = 4483362458
        })
    end
})

--// STATS TAB
local StatsTab = Window:CreateTab("ðŸ“ˆ Stats", 4483362458)

StatsTab:CreateSection("Stat Boosters")

StatsTab:CreateToggle({
    Name = "ðŸ”¥ Win Streak Booster",
    CurrentValue = false,
    Flag = "WinStreak",
    Callback = function(Value)
        _G.YSL.WinStreakBoost = Value
        SetupWinStreak()
    end
})

StatsTab:CreateToggle({
    Name = "ðŸ’€ Execution Booster",
    CurrentValue = false,
    Flag = "Executions",
    Callback = function(Value)
        _G.YSL.ExecutionBoost = Value
        SetupExecutions()
    end
})

StatsTab:CreateSection("Instant Changes")

StatsTab:CreateButton({
    Name = "ðŸ”¥ Set Win Streak to 100",
    Callback = function()
        local ls = lplayer:FindFirstChild("leaderstats")
        if ls then
            local ws = ls:FindFirstChild("Win Streak")
            if ws then
                ws.Value = 100
            end
        end
    end
})

StatsTab:CreateButton({
    Name = "ðŸ’€ Set Executions to 1000",
    Callback = function()
        local ls = lplayer:FindFirstChild("leaderstats")
        if ls then
            local ex = ls:FindFirstChild("Executions")
            if ex then
                ex.Value = 1000
            end
        end
    end
})

--// MOVEMENT TAB
local MovementTab = Window:CreateTab("ðŸš€ Movement", 4483362458)

MovementTab:CreateToggle({
    Name = "ðŸš€ Speed Hack",
    CurrentValue = false,
    Flag = "Speed",
    Callback = function(Value)
        _G.YSL.Speed = Value
        SetupSpeed()
    end
})

MovementTab:CreateSlider({
    Name = "Speed Value",
    Range = {20, 500},
    Increment = 10,
    Suffix = " Speed",
    CurrentValue = 100,
    Flag = "SpeedValue",
    Callback = function(Value)
        _G.YSL.SpeedValue = Value
        if _G.YSL.Speed then SetupSpeed() end
    end
})

MovementTab:CreateToggle({
    Name = "â™¾ï¸ Infinite Jump",
    CurrentValue = false,
    Flag = "InfJump",
    Callback = function(Value)
        _G.YSL.InfJump = Value
    end
})

MovementTab:CreateToggle({
    Name = "ðŸ‘» No Clip",
    CurrentValue = false,
    Flag = "NoClip",
    Callback = function(Value)
        _G.YSL.NoClip = Value
        SetupNoClip()
    end
})

--// VISUAL TAB
local VisualTab = Window:CreateTab("ðŸ‘ï¸ Visual", 4483362458)

VisualTab:CreateToggle({
    Name = "ðŸ‘¤ Player ESP",
    CurrentValue = false,
    Flag = "PlayerESP",
    Callback = function(Value)
        _G.YSL.PlayerESP = Value
        SetupESP()
    end
})

VisualTab:CreateButton({
    Name = "ðŸ§¹ Clear All ESP",
    Callback = function()
        RemoveESP()
    end
})

VisualTab:CreateToggle({
    Name = "â˜€ï¸ Full Brightness",
    CurrentValue = false,
    Flag = "FullBright",
    Callback = function(Value)
        _G.YSL.FullBright = Value
        SetupFullBright()
    end
})

--// INFINITE JUMP
UserInputService.JumpRequest:Connect(function()
    if _G.YSL.InfJump then
        local hum = GetHumanoid()
        if hum then
            hum:ChangeState(Enum.HumanoidStateType.Jumping)
        end
    end
end)

--// CHARACTER RESPAWN
lplayer.CharacterAdded:Connect(function()
    task.wait(1)
    if _G.YSL.Speed then SetupSpeed() end
    if _G.YSL.NoClip then SetupNoClip() end
end)

--// DONE
Rayfield:Notify({
    Title = "âš¡ YslMenu Ultimate Loaded",
    Content = "Game analyzed! Check all tabs for features.",
    Duration = 5,
    Image = 4483362458
})

print("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
print("  YslMenu - Last Letter V6.0 ULTIMATE")
print("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
print("âœ… GAME CONSTANTS: " .. (next(Constants) and "LOADED" or "PROTECTED"))
print("âœ… ITEMS: " .. (next(GameItems) and "LOADED" or "PROTECTED"))
print("âœ… REMOTE: " .. (MainRemote and "FOUND" or "NOT FOUND"))
print("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
print("ðŸ”¥ ysl on top ðŸ˜ˆ")
print("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
